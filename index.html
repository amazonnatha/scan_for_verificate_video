import qrcode
import os
from PIL import Image, ImageDraw, ImageFont

# --- CONFIGURATION ---
# 1. Base URL for your live GitHub Pages website (NO verification parameter needed)
LIVE_WEBPAGE_URL = "https://amazonnatha.github.io/scan_for_verificate_video/"

# The text label to display beneath the QR code image
FILE_LABEL = "testsapphiregreen.mp4" 

# Directory to save the QR code image
output_dir = 'static_qr_code_final'
os.makedirs(output_dir, exist_ok=True) 

# Create a QR Code
qr = qrcode.QRCode(
    version=1,
    error_correction=qrcode.constants.ERROR_CORRECT_H,
    box_size=10,
    border=4,
)

# Add the static LIVE WEBPAGE URL to the QR code
qr.add_data(LIVE_WEBPAGE_URL)
qr.make(fit=True)

# Generate the QR code image
qr_code_img = qr.make_image(fill_color="black", back_color="white").convert("RGB")

# Create a new image with space for the text label
new_img = Image.new("RGB", (qr_code_img.width, qr_code_img.height + qr_code_img.width // 4), "white")
new_img.paste(qr_code_img, (0, 0))

# Draw the text label
draw = ImageDraw.Draw(new_img)
try:
    font_size = qr_code_img.width // 10
    font = ImageFont.truetype("Arial.ttf", font_size)
except IOError:
    font = ImageFont.load_default() 

# Center the text label
text_bbox = draw.textbbox((0, 0), FILE_LABEL, font=font)
text_width = text_bbox[2] - text_bbox[0]
text_x = (new_img.width - text_width) // 2
text_y = qr_code_img.height + 10 

draw.text((text_x, text_y), FILE_LABEL, fill="black", font=font)

# Save the final image
qr_file_name = f"{output_dir}/{FILE_LABEL}_static_webpage_qr.png"
new_img.save(qr_file_name)

print(f"âœ… FINAL QR Code generated successfully at: {qr_file_name}")
print(f"The QR code links to the webpage: {LIVE_WEBPAGE_URL}")
